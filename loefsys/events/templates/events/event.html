{% extends "base.html" %}
{% load static %}

{% block title %}
    {{ event.title }}
{% endblock %}

{% block content %}
<div class="flex flex-col h-screen">
    <section id="event-details" class="bg-[#234193] p-8 flex flex-col">
        <h1 class="text-6xl font-bold text-white pb-8 mt-4"> {{event.title}}</h1>

    </section>

    <section id="event-detail" class="bg-[#1BB1E6] flex-auto p-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-2xl">
            <div class="border p-4 rounded-xl bg-gray-100 col-span-2 flex gap-2">
                <span class="font-bold whitespace-nowrap text-lg">Beschrijving: </span> 
                <span class="text-lg">{{ event.description }}</span>
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Starttijd:</span> {{ event.start|date:"d/m/y H:i" }}
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Eindtijd:</span> {{ event.end|date:"d/m/y H:i" }}
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Registratie Start:</span> {{ event.registration_start|date:"d/m/y H:i" }}
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Registratie Deadline:</span> {{ event.registration_deadline|date:"d/m/y H:i" }}
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Locatie:</span> {{ event.location }}
            </div>
            <div class="border p-4 rounded-xl bg-gray-100">
                <span class="font-bold">Prijs:</span> {{ event.price }}
            </div>
        </div>
        <div class="border p-4 rounded-xl bg-gray-100 justify-center mt-4">
            <button id="registration-button" class="font-bold text-3xl bg-gray-100 py-2 px-4 rounded">
            </button>
            <script>
            const now = new Date();
            const registrationStart = new Date("{{ event.registration_start|date:'Y-m-d H:i:s' }}");
            const registrationDeadline = new Date("{{ event.registration_deadline|date:'Y-m-d H:i:s' }}");
            const registrationButton = document.getElementById("registration-button");

            if (now >= registrationStart && now <= registrationDeadline) {
            registrationButton.textContent = "Inschrijven is mogelijk";
            } else {
            registrationButton.textContent = "Inschrijven voor dit evenement is niet meer mogelijk";
            }

            registrationButton.addEventListener("click", () => {
            if (now >= registrationStart && now <= registrationDeadline) {
                alert("Inschrijven is mogelijk!");
                const form = document.createElement("form");
                form.method = "post";
                form.action = "";

                const csrfTokenInput = document.createElement("input");
                csrfTokenInput.type = "hidden";
                csrfTokenInput.name = "csrfmiddlewaretoken";
                csrfTokenInput.value = "{{ csrf_token }}";

                const submitInput = document.createElement("input");
                submitInput.type = "submit";
                submitInput.value = "Register";
                submitInput.className = "btn btn-primary";

                form.appendChild(csrfTokenInput);
                form.appendChild(submitInput);

                document.body.appendChild(form);
                form.submit();
            } else {
                alert("Inschrijven voor dit evenement is niet meer mogelijk.");
            }
            });
            </script>
        </div>
    </section>

</div>
{% endblock %}
